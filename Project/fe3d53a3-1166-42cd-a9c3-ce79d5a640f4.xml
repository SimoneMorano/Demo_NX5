<StructuredTextModel xmlns="http://schemas.datacontract.org/2004/07/Omron.Cxap.Modules.StructuredText.Core" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><Text>CASE state OF&#xD;
	0:&#xD;
		Done:=FALSE;&#xD;
		IF (Execute=TRUE)  THEN&#xD;
			Error:= FALSE;&#xD;
			ErrorID:=16#0;&#xD;
			Busy:=TRUE;&#xD;
			Active:=FALSE;&#xD;
			state:= 3;&#xD;
		END_IF;&#xD;
		&#xD;
	3:&#xD;
		Axis.Profile_deceleration:=LREAL_TO_UDINT(Deceleration);			&#xD;
		Active:=TRUE;&#xD;
		state:= 5;&#xD;
	&#xD;
	5:&#xD;
		Axis.ControlWord := Axis.ControlWord OR WORD#2#0000_0001_0000_0000;   //Set Halt bit&#xD;
		state:= 10;&#xD;
&#xD;
	10:&#xD;
		Axis.Cmd.Pos:= Axis.Act.Pos;&#xD;
		IF ((Axis.StatusWord AND WORD#2#0001_0000_0010_0000) = WORD#2#0001_0000_0010_0000)  OR &#xD;
			((Axis.StatusWord AND WORD#2#0000_0110_0011_0000) = WORD#2#0000_0110_0011_0000) THEN  //Bit 5 and 12 in statusword    OR  9+10 and 4+5&#xD;
			state := 20;    //wait until standstill&#xD;
			//Axis.ControlWord := Axis.ControlWord AND WORD#2#1111_1110_1111_1111;   //Reset Bit 8 Halt&#xD;
		ELSIF (not Axis.DrvStatus.ServoOn) OR (NOT Axis.DrvStatus.Ready) OR (Axis.DrvStatus.DrvAlarm) THEN&#xD;
			ErrorID := ERR_SERVO_OFF;			//16#5441 operation with servo off&#xD;
			Error := TRUE;&#xD;
			state := 10010;&#xD;
		END_IF;&#xD;
	20:&#xD;
		IF ((Axis.ModeOfOperation = 1) AND ((Axis.StatusWord AND WORD#2#0000_0100_0000_0000) = WORD#2#0000_0100_0000_0000)   //PP mode Bit 10 Targed reachted&#xD;
			OR (Axis.ModeOfOperation = 3) AND ((Axis.StatusWord AND WORD#2#0001_0000_0000_0000) = WORD#2#0001_0000_0000_0000)  // PV mode Bit 12 in Statusword Zero speed detect&#xD;
			OR (Axis.ModeOfOperation = 6) AND ((Axis.StatusWord AND WORD#2#0000_0100_0000_0000) = WORD#2#0000_0100_0000_0000)) THEN  // Home mode Bit 10 in Statusword targed reached THEN	&#xD;
			Busy := FALSE;&#xD;
			Active := FALSE;&#xD;
			Done := TRUE;&#xD;
			state := 0;   //standstill&#xD;
		ELSIF (not Axis.DrvStatus.ServoOn) OR (NOT Axis.DrvStatus.Ready) OR (Axis.DrvStatus.DrvAlarm) THEN&#xD;
			ErrorID := ERR_SERVO_OFF;			//16#5441 operation with servo off&#xD;
			Error := TRUE;&#xD;
			state := 10020;&#xD;
		END_IF;&#xD;
		&#xD;
	10000..20000:&#xD;
		Active:=0;&#xD;
		Busy:=0;&#xD;
		state := 0;&#xD;
		Axis.ControlWord := Axis.ControlWord OR WORD#2#0000_0001_0000_0000;   //Set Bit 8 Halt&#xD;
END_CASE;&#xD;
</Text></StructuredTextModel>